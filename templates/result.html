<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Analysis Results â€” JD Analyzer Â· Groq</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
</head>
<body class="result-page">

  <!-- Page Header -->
  <header class="result-header">
    <div class="result-header-inner">
      <a href="/" class="back-link">
        <svg width="16" height="16" viewBox="0 0 20 20" fill="none">
          <path d="M16 10H4M9 5l-5 5 5 5" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Analyze another JD
      </a>
      <div class="nav-brand">
        <svg width="22" height="22" viewBox="0 0 28 28" fill="none">
          <rect width="28" height="28" rx="8" fill="#1560BD"/>
          <path d="M8 8h7a5 5 0 010 10H8V8z" fill="white" opacity="0.9"/>
          <rect x="8" y="20" width="12" height="2" rx="1" fill="white" opacity="0.6"/>
        </svg>
        <span class="brand-name">JD Analyzer</span>
      </div>
      <span class="gemini-pill">âš¡ Groq AI</span>
    </div>
  </header>

  <main class="result-main">

    {# â”€â”€ Overall Score Hero â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #}
    {% set os = results.overall_score %}
    {% set os_circ = 452.389 %}
    {% set os_offset = (os_circ * (1 - os / 100)) | round(2) %}

    <section class="score-hero">
      <div class="score-hero-ring">
        <svg class="big-ring-svg" viewBox="0 0 180 180" aria-label="Overall score {{ os }} out of 100">
          <circle cx="90" cy="90" r="72" class="ring-track" stroke-width="10"/>
          <circle cx="90" cy="90" r="72"
                  class="ring-progress"
                  stroke-width="10"
                  stroke-dasharray="{{ os_circ }}"
                  stroke-dashoffset="{{ os_circ }}"
                  data-target="{{ os_offset }}"
                  style="stroke: {{ os | score_color }};"
                  transform="rotate(-90 90 90)"/>
          <text x="90" y="82" class="ring-score-text" text-anchor="middle" dominant-baseline="central">{{ os }}</text>
          <text x="90" y="108" class="ring-score-label" text-anchor="middle" dominant-baseline="central">/100</text>
        </svg>
      </div>

      <div class="score-hero-info">
        <span class="verdict-badge verdict-{{ results.verdict | lower | replace(' ', '-') }}">
          {{ results.verdict }}
        </span>
        <h1 class="score-hero-title">Overall Quality Score</h1>
        <p class="score-hero-summary">{{ results.executive_summary }}</p>
      </div>
    </section>

    {# â”€â”€ Category Analysis â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #}
    {% set cat_meta = [
      ('clarity',      'âœï¸', 'Clarity'),
      ('inclusivity',  'ğŸ¤', 'Inclusivity'),
      ('structure',    'ğŸ“‹', 'Structure'),
      ('tone',         'ğŸ’¬', 'Tone'),
      ('requirements', 'âœ…', 'Requirements')
    ] %}

    <section class="section">
      <h2 class="section-title">Category Analysis</h2>
      <div class="categories-grid">
        {% for key, icon, label in cat_meta %}
          {% set cat = results.categories[key] %}
          {% set c_circ = 301.593 %}
          {% set c_offset = (c_circ * (1 - cat.score / 100)) | round(2) %}
          <div class="cat-card">
            <div class="cat-ring-wrap">
              <svg class="cat-ring-svg" viewBox="0 0 120 120" aria-label="{{ label }} score {{ cat.score }}">
                <circle cx="60" cy="60" r="48" class="ring-track" stroke-width="8"/>
                <circle cx="60" cy="60" r="48"
                        class="ring-progress"
                        stroke-width="8"
                        stroke-dasharray="{{ c_circ }}"
                        stroke-dashoffset="{{ c_circ }}"
                        data-target="{{ c_offset }}"
                        style="stroke: {{ cat.score | score_color }};"
                        transform="rotate(-90 60 60)"/>
                <text x="60" y="55" class="cat-score-text" text-anchor="middle" dominant-baseline="central">{{ cat.score }}</text>
                <text x="60" y="74" class="cat-grade-text" text-anchor="middle" dominant-baseline="central"
                      style="fill: {{ cat.score | score_color }};">{{ cat.grade }}</text>
              </svg>
            </div>
            <div class="cat-icon">{{ icon }}</div>
            <h3 class="cat-label">{{ label }}</h3>
            <p class="cat-summary">{{ cat.summary }}</p>

            {% if cat.details %}
            <ul class="cat-details">
              {% for detail in cat.details %}
              <li>{{ detail }}</li>
              {% endfor %}
            </ul>
            {% endif %}

            {% if key == 'inclusivity' and cat.biased_terms %}
            <div class="biased-terms">
              <span class="biased-label">Terms flagged:</span>
              {% for term in cat.biased_terms %}
              <span class="biased-tag">{{ term }}</span>
              {% endfor %}
            </div>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    </section>

    {# â”€â”€ Strengths & Issues â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #}
    <div class="two-col-grid">

      <section class="panel panel-green">
        <h2 class="panel-title">
          <svg width="18" height="18" viewBox="0 0 20 20" fill="none"><circle cx="10" cy="10" r="9" stroke="#059669" stroke-width="1.5"/><path d="M6.5 10l2.5 2.5 4.5-4.5" stroke="#059669" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
          Strengths
        </h2>
        <ul class="panel-list">
          {% for item in results.strengths %}
          <li class="panel-item panel-item-green">{{ item }}</li>
          {% endfor %}
        </ul>
      </section>

      <section class="panel panel-red">
        <h2 class="panel-title">
          <svg width="18" height="18" viewBox="0 0 20 20" fill="none"><circle cx="10" cy="10" r="9" stroke="#DC2626" stroke-width="1.5"/><path d="M10 6v4M10 14h.01" stroke="#DC2626" stroke-width="1.5" stroke-linecap="round"/></svg>
          Issues Found
        </h2>
        {% if results.issues %}
        <ul class="issue-list">
          {% for issue in results.issues %}
          <li class="issue-item">
            <span class="severity-badge sev-{{ issue.severity | lower }}">{{ issue.severity }}</span>
            <div class="issue-body">
              <span class="issue-category">{{ issue.category }}</span>
              <p class="issue-desc">{{ issue.description }}</p>
            </div>
          </li>
          {% endfor %}
        </ul>
        {% else %}
        <p class="panel-empty">No significant issues detected.</p>
        {% endif %}
      </section>

    </div>

    {# â”€â”€ Suggestions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #}
    {% if results.suggestions %}
    <section class="section">
      <h2 class="section-title">
        ğŸ’¡ Suggestions to Improve
      </h2>
      <div class="suggestions-list">
        {% for sug in results.suggestions %}
        <div class="suggestion-card">
          <div class="suggestion-header">
            <span class="priority-badge pri-{{ sug.priority | lower }}">{{ sug.priority }}</span>
            <h4 class="suggestion-title">{{ sug.title }}</h4>
          </div>
          <p class="suggestion-desc">{{ sug.description }}</p>
        </div>
        {% endfor %}
      </div>
    </section>
    {% endif %}

    {# â”€â”€ Extracted Information â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ #}
    {% set info = results.extracted_info %}
    <section class="section">
      <h2 class="section-title">ğŸ“Š Extracted Information</h2>
      <div class="extracted-card">

        <div class="extracted-meta">
          <div class="meta-item">
            <span class="meta-label">Role</span>
            <span class="meta-value">{{ info.job_title }}</span>
          </div>
          <div class="meta-divider"></div>
          <div class="meta-item">
            <span class="meta-label">Seniority</span>
            <span class="meta-value">{{ info.seniority }}</span>
          </div>
        </div>

        {% if info.tech_skills %}
        <div class="skills-row">
          <span class="skills-row-label">Tech Skills</span>
          <div class="tags-wrap">
            {% for skill in info.tech_skills %}
            <span class="tag tag-blue">{{ skill }}</span>
            {% endfor %}
          </div>
        </div>
        {% endif %}

        {% if info.soft_skills %}
        <div class="skills-row">
          <span class="skills-row-label">Soft Skills</span>
          <div class="tags-wrap">
            {% for skill in info.soft_skills %}
            <span class="tag tag-purple">{{ skill }}</span>
            {% endfor %}
          </div>
        </div>
        {% endif %}

        {% if info.key_responsibilities %}
        <div class="responsibilities">
          <span class="skills-row-label">Key Responsibilities</span>
          <ul class="resp-list">
            {% for resp in info.key_responsibilities %}
            <li>{{ resp }}</li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}

      </div>
    </section>

    <!-- Footer CTA -->
    <div class="result-footer">
      <a href="/" class="btn-back">â† Analyze Another Job Description</a>
    </div>

  </main>

  <script>
    // Animate all score rings on page load
    window.addEventListener('load', function () {
      const rings = document.querySelectorAll('.ring-progress[data-target]');
      rings.forEach(function (ring) {
        const target = parseFloat(ring.dataset.target);
        // Set starting point = full circumference (no fill)
        ring.style.strokeDashoffset = ring.getAttribute('stroke-dasharray');
        ring.style.transition = 'none';
        requestAnimationFrame(function () {
          requestAnimationFrame(function () {
            ring.style.transition = 'stroke-dashoffset 1.1s cubic-bezier(0.4, 0, 0.2, 1)';
            ring.style.strokeDashoffset = target;
          });
        });
      });
    });
  </script>
</body>
</html>
